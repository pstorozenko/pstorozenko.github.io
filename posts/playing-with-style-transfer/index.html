<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Playing With Style Transfer ðŸŽ¨ | Pasza&#39;s blog</title>
<meta name="keywords" content="python, machine-learning, conference, SFI 2022">
<meta name="description" content="As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN.
In this post I would like to show you how easy it is to play with style transfer on your own!
To tutorial or not to tutorial
It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system.
But what if you do not want to learn anything?
Maybe all you want is just to do the style transfer on your photos?
Apparently tutorials with colab notebooks are all you need!">
<meta name="author" content="">
<link rel="canonical" href="/posts/playing-with-style-transfer/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/posts/playing-with-style-transfer/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

>
<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-PR8Z9SJC7F"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-PR8Z9SJC7F');
        }
      </script><meta property="og:url" content="/posts/playing-with-style-transfer/">
  <meta property="og:site_name" content="Pasza&#39;s blog">
  <meta property="og:title" content="Playing With Style Transfer ðŸŽ¨">
  <meta property="og:description" content="As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN. In this post I would like to show you how easy it is to play with style transfer on your own!
To tutorial or not to tutorial It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system. But what if you do not want to learn anything? Maybe all you want is just to do the style transfer on your photos? Apparently tutorials with colab notebooks are all you need!">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-02-05T21:12:18+01:00">
    <meta property="article:modified_time" content="2022-02-05T21:12:18+01:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Machine-Learning">
    <meta property="article:tag" content="Conference">
    <meta property="article:tag" content="SFI 2022">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Playing With Style Transfer ðŸŽ¨">
<meta name="twitter:description" content="As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN.
In this post I would like to show you how easy it is to play with style transfer on your own!
To tutorial or not to tutorial
It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system.
But what if you do not want to learn anything?
Maybe all you want is just to do the style transfer on your photos?
Apparently tutorials with colab notebooks are all you need!">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Playing With Style Transfer ðŸŽ¨",
      "item": "/posts/playing-with-style-transfer/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Playing With Style Transfer ðŸŽ¨",
  "name": "Playing With Style Transfer ðŸŽ¨",
  "description": "As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN. In this post I would like to show you how easy it is to play with style transfer on your own!\nTo tutorial or not to tutorial It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system. But what if you do not want to learn anything? Maybe all you want is just to do the style transfer on your photos? Apparently tutorials with colab notebooks are all you need!\n",
  "keywords": [
    "python", "machine-learning", "conference", "SFI 2022"
  ],
  "articleBody": "As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN. In this post I would like to show you how easy it is to play with style transfer on your own!\nTo tutorial or not to tutorial It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system. But what if you do not want to learn anything? Maybe all you want is just to do the style transfer on your photos? Apparently tutorials with colab notebooks are all you need!\nWhat are the colab notebooks? Some long time ago Google launched the service Google Colab. This is an online place where you can run your jupyter notebooks on a machine with attached GPU for free! Of course there is a limit on GPU time you can use, but it is usually enough to train some simple networks or fine-tune the pre-trained model. If you are not familiar with colab yet, definitely try it out. It might come handy, e.g., for studentâ€™s project or recruitment assignment if you do not have GPU at home.\nSimple neural style transfer We will go through the beginning of the Neural style transfer tutorial. Press the big Run in Google Colab button on top and wait till the environment loads.\nYou can work in colab almost the same you would work with jupyter notebooks! The whole tutorial is just one massive jupyter notebook. Scroll down to some code and hit Shift + Enter to run the first code cell!\nIf you do the same with some further cells you will quickly obtain the following abstract dog.\nJust look how quick, painless and easy it was! No need for environment setting up or doing any other difficult stuff!\nAdjusting for images from the web Since this is just a jupyter notebook you run, it is easy to adjust it to your needs. Just edit lines:\ncontent_path = tf.keras.utils.get_file('YellowLabradorLooking_new.jpg', 'https://storage.googleapis.com/download.tensorflow.org/example_images/YellowLabradorLooking_new.jpg') style_path = tf.keras.utils.get_file('kandinsky5.jpg','https://storage.googleapis.com/download.tensorflow.org/example_images/Vassily_Kandinsky%2C_1913_-_Composition_7.jpg') With changing for example the yellow labrador dog url into the Warsaw University of Technology main building url and re-run a few cells.\ncontent_path = tf.keras.utils.get_file('1280px-Gmach_G%C5%82%C3%B3wny_Politechniki_Warszawskiej_2018.jpg', 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Gmach_G%C5%82%C3%B3wny_Politechniki_Warszawskiej_2018.jpg/1280px-Gmach_G%C5%82%C3%B3wny_Politechniki_Warszawskiej_2018.jpg') Adjusting for images from you local disk If you want to upload an image from your local disk to process you can do it as well! Just click here and there:\nand adjust a cell from\ncontent_image = load_img(content_path) style_image = load_img(style_path) to\ncontent_image = load_img(\"the-eiffel-tower.jpg\") style_image = load_img(\"a-summer-evening-in-the-city.jpg\") and re run everything.\nA summer evening in the city with the Eiffel Tower.\nSummary Colab notebooks is a great online service. I hope this post made it clear how to do your own experiments with style transfer. And the best part is that if you are curious how style transfer works, what are the details of methods used, just follow the notebook till the end!\n",
  "wordCount" : "482",
  "inLanguage": "en",
  "datePublished": "2022-02-05T21:12:18+01:00",
  "dateModified": "2022-02-05T21:12:18+01:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/playing-with-style-transfer/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Pasza's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Pasza&#39;s blog (Alt + H)">Pasza&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/about" title="About me">
                    <span>About me</span>
                </a>
            </li>
            <li>
                <a href="/useful-materials" title="Useful materials">
                    <span>Useful materials</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Playing With Style Transfer ðŸŽ¨
    </h1>
    <div class="post-meta"><span title='2022-02-05 21:12:18 +0100 +0100'>February 5, 2022</span>

</div>
  </header> 
  <div class="post-content"><p><a href="/posts/sfi-conference/">As mentioned earlier</a>, I will be giving a talk on <a href="https://sfi.pl/en/">the 17th SFI IT Academic Festival</a> on the topic of style transfer and StyleGAN.
In this post I would like to show you how easy it is to play with style transfer on your own!</p>
<h2 id="to-tutorial-or-not-to-tutorial">To tutorial or not to tutorial<a hidden class="anchor" aria-hidden="true" href="#to-tutorial-or-not-to-tutorial">#</a></h2>
<p>It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system.
But what if you do not want to learn anything?
Maybe all you want is just to do the style transfer on your photos?
Apparently tutorials with colab notebooks are all you need!</p>
<h2 id="what-are-the-colab-notebooks">What are the colab notebooks?<a hidden class="anchor" aria-hidden="true" href="#what-are-the-colab-notebooks">#</a></h2>
<p>Some long time ago Google launched the service <a href="https://colab.research.google.com/">Google Colab</a>.
This is an online place where you can run your jupyter notebooks on a machine with attached GPU for free!
Of course there is a limit on GPU time you can use, but it is usually enough to train some simple networks or fine-tune the pre-trained model.
If you are not familiar with colab yet, definitely try it out.
It might come handy, e.g., for student&rsquo;s project or recruitment assignment if you do not have GPU at home.</p>
<h2 id="simple-neural-style-transfer">Simple neural style transfer<a hidden class="anchor" aria-hidden="true" href="#simple-neural-style-transfer">#</a></h2>
<p>We will go through the beginning of the <a href="https://www.tensorflow.org/tutorials/generative/style_transfer">Neural style transfer</a> tutorial.
Press the big <strong>Run in Google Colab</strong> button on top and wait till the environment loads.</p>
<p><a href="https://colab.research.google.com/github/tensorflow/docs/blob/master/site/en/tutorials/generative/style_transfer.ipynb"><img loading="lazy" src="/posts/playing-with-style-transfer/run_in_colab.png"></a></p>
<p>You can work in colab almost the same you would work with jupyter notebooks!
The whole tutorial is just one massive jupyter notebook.
Scroll down to some code and hit <kbd>Shift</kbd> + <kbd>Enter</kbd> to run the first code cell!</p>
<p><img loading="lazy" src="/posts/playing-with-style-transfer/first_cell.png"></p>
<p>If you do the same with some further cells you will quickly obtain the following abstract dog.</p>
<p><img loading="lazy" src="/posts/playing-with-style-transfer/dog.png"></p>
<p>Just look how quick, painless and easy it was!
No need for environment setting up or doing any other difficult stuff!</p>
<h3 id="adjusting-for-images-from-the-web">Adjusting for images from the web<a hidden class="anchor" aria-hidden="true" href="#adjusting-for-images-from-the-web">#</a></h3>
<p>Since this is just a jupyter notebook you run, it is easy to adjust it to your needs.
Just edit lines:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>content_path <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>utils<span style="color:#f92672">.</span>get_file(<span style="color:#e6db74">&#39;YellowLabradorLooking_new.jpg&#39;</span>, <span style="color:#e6db74">&#39;https://storage.googleapis.com/download.tensorflow.org/example_images/YellowLabradorLooking_new.jpg&#39;</span>)
</span></span><span style="display:flex;"><span>style_path <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>utils<span style="color:#f92672">.</span>get_file(<span style="color:#e6db74">&#39;kandinsky5.jpg&#39;</span>,<span style="color:#e6db74">&#39;https://storage.googleapis.com/download.tensorflow.org/example_images/Vassily_Kandinsky%2C_1913_-_Composition_7.jpg&#39;</span>)
</span></span></code></pre></div><p>With changing for example the yellow labrador dog url into the Warsaw University of Technology main building url and re-run a few cells.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>content_path <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>utils<span style="color:#f92672">.</span>get_file(<span style="color:#e6db74">&#39;1280px-Gmach_G%C5</span><span style="color:#e6db74">%82%</span><span style="color:#e6db74">C3%B3wny_Politechniki_Warszawskiej_2018.jpg&#39;</span>, <span style="color:#e6db74">&#39;https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Gmach_G%C5</span><span style="color:#e6db74">%82%</span><span style="color:#e6db74">C3%B3wny_Politechniki_Warszawskiej_2018.jpg/1280px-Gmach_G%C5</span><span style="color:#e6db74">%82%</span><span style="color:#e6db74">C3%B3wny_Politechniki_Warszawskiej_2018.jpg&#39;</span>)
</span></span></code></pre></div><p><img alt="Abstract WUT Main Building" loading="lazy" src="/posts/playing-with-style-transfer/ggpw_abstro.png"></p>
<h3 id="adjusting-for-images-from-you-local-disk">Adjusting for images from you local disk<a hidden class="anchor" aria-hidden="true" href="#adjusting-for-images-from-you-local-disk">#</a></h3>
<p>If you want to upload an image from your local disk to process you can do it as well!
Just click here and there:</p>
<p><img loading="lazy" src="/posts/playing-with-style-transfer/upload.png"></p>
<p>and adjust a cell from</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>content_image <span style="color:#f92672">=</span> load_img(content_path)
</span></span><span style="display:flex;"><span>style_image <span style="color:#f92672">=</span> load_img(style_path)
</span></span></code></pre></div><p>to</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>content_image <span style="color:#f92672">=</span> load_img(<span style="color:#e6db74">&#34;the-eiffel-tower.jpg&#34;</span>)
</span></span><span style="display:flex;"><span>style_image <span style="color:#f92672">=</span> load_img(<span style="color:#e6db74">&#34;a-summer-evening-in-the-city.jpg&#34;</span>)
</span></span></code></pre></div><p>and re run everything.</p>
<p><img alt="Eiffel Tower in Van Gogh Style" loading="lazy" src="/posts/playing-with-style-transfer/eiffel.png"></p>
<p>A summer evening <del>in the city</del> with the Eiffel Tower.</p>
<h2 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h2>
<p>Colab notebooks is a great online service.
I hope this post made it clear how to do your own experiments with style transfer.
And the best part is that if you are curious how style transfer works, what are the details of methods used, just follow the notebook till the end!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/python/">Python</a></li>
      <li><a href="/tags/machine-learning/">Machine-Learning</a></li>
      <li><a href="/tags/conference/">Conference</a></li>
      <li><a href="/tags/sfi-2022/">SFI 2022</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>Piotr Pasza StoroÅ¼enko</span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
