<!doctype html><html lang=en><head><title>Playing With Style Transfer 🎨 ::
Pasza's blog — a simple blog about complex things</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN. In this post I would like to show you how easy it is to play with style transfer on your own!
To tutorial or not to tutorial # It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system."><meta name=keywords content="piotr pasza pasha storozenko ml data science machine learning"><meta name=robots content="noodp"><link rel=canonical href=/posts/playing-with-style-transfer/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.css integrity=sha384-ysFyB7Is//Q1JNgERb0bLJokXKM8eWJsjEutGvthoHtBilHWgbdmbYkQZdwCIGIq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.js integrity=sha384-UWjC+k927Mtx6WQF5SzKTXLLrOYmzs69HvkUjiKvUwSOljzc+C6PrGquNpOvJBBo crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PR8Z9SJC7F"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PR8Z9SJC7F",{anonymize_ip:!1})}</script><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon.png><link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="Playing With Style Transfer 🎨"><meta name=twitter:description content="As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN. In this post I would like to show you how easy it is to play with style transfer on your own!
To tutorial or not to tutorial # It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system."><meta property="og:title" content="Playing With Style Transfer 🎨"><meta property="og:description" content="As mentioned earlier, I will be giving a talk on the 17th SFI IT Academic Festival on the topic of style transfer and StyleGAN. In this post I would like to show you how easy it is to play with style transfer on your own!
To tutorial or not to tutorial # It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system."><meta property="og:type" content="article"><meta property="og:url" content="/posts/playing-with-style-transfer/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-05T21:12:18+01:00"><meta property="article:modified_time" content="2022-02-05T21:12:18+01:00"><meta property="og:site_name" content="Pasza's blog"></head><body class=light-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>pasza's blog</span>
<span class=logo__cursor></span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About me</a></li><li><a href=/useful-materials>Useful materials</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About me</a></li><li><a href=/useful-materials>Useful materials</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>Playing With Style Transfer 🎨</h1><div class=post-meta><span class=post-date>2022-02-05</span></div><span class=post-tags><a href=/tags/python/>#python</a>&nbsp;
<a href=/tags/machine-learning/>#machine-learning</a>&nbsp;
<a href=/tags/conference/>#conference</a>&nbsp;
<a href=/tags/sfi-2022/>#SFI 2022</a>&nbsp;</span><div class=post-content><p><a href=/posts/sfi-conference>As mentioned earlier</a>, I will be giving a talk on <a href=https://sfi.pl/en/>the 17th SFI IT Academic Festival</a> on the topic of style transfer and StyleGAN.
In this post I would like to show you how easy it is to play with style transfer on your own!</p><h2 id=to-tutorial-or-not-to-tutorial>To tutorial or not to tutorial
<a href=#to-tutorial-or-not-to-tutorial class=h-anchor aria-hidden=true>#</a></h2><p>It might be obvious for you to check Tensorflow/PyTorch tutorials if you wanted to learn how to create style-transfer system.
But what if you do not want to learn anything?
Maybe all you want is just to do the style transfer on your photos?
Apparently tutorials with colab notebooks are all you need!</p><h2 id=what-are-the-colab-notebooks>What are the colab notebooks?
<a href=#what-are-the-colab-notebooks class=h-anchor aria-hidden=true>#</a></h2><p>Some long time ago Google launched the service <a href=https://colab.research.google.com/>Google Colab</a>.
This is an online place where you can run your jupyter notebooks on a machine with attached GPU for free!
Of course there is a limit on GPU time you can use, but it is usually enough to train some simple networks or fine-tune the pre-trained model.
If you are not familiar with colab yet, definitely try it out.
It might come handy, e.g., for student&rsquo;s project or recruitment assignment if you do not have GPU at home.</p><h2 id=simple-neural-style-transfer>Simple neural style transfer
<a href=#simple-neural-style-transfer class=h-anchor aria-hidden=true>#</a></h2><p>We will go through the beginning of the <a href=https://www.tensorflow.org/tutorials/generative/style_transfer>Neural style transfer</a> tutorial.
Press the big <strong>Run in Google Colab</strong> button on top and wait till the environment loads.</p><p><a href=https://colab.research.google.com/github/tensorflow/docs/blob/master/site/en/tutorials/generative/style_transfer.ipynb><img src=/posts/playing-with-style-transfer/run_in_colab.png alt></a></p><p>You can work in colab almost the same you would work with jupyter notebooks!
The whole tutorial is just one massive jupyter notebook.
Scroll down to some code and hit Shift + Enter to run the first code cell!</p><p><img src=/posts/playing-with-style-transfer/first_cell.png alt></p><p>If you do the same with some further cells you will quickly obtain the following abstract dog.</p><p><img src=/posts/playing-with-style-transfer/dog.png alt></p><p>Just look how quick, painless and easy it was!
No need for environment setting up or doing any other difficult stuff!</p><h3 id=adjusting-for-images-from-the-web>Adjusting for images from the web
<a href=#adjusting-for-images-from-the-web class=h-anchor aria-hidden=true>#</a></h3><p>Since this is just a jupyter notebook you run, it is easy to adjust it to your needs.
Just edit lines:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>content_path <span style=color:#f92672>=</span> tf<span style=color:#f92672>.</span>keras<span style=color:#f92672>.</span>utils<span style=color:#f92672>.</span>get_file(<span style=color:#e6db74>&#39;YellowLabradorLooking_new.jpg&#39;</span>, <span style=color:#e6db74>&#39;https://storage.googleapis.com/download.tensorflow.org/example_images/YellowLabradorLooking_new.jpg&#39;</span>)
</span></span><span style=display:flex><span>style_path <span style=color:#f92672>=</span> tf<span style=color:#f92672>.</span>keras<span style=color:#f92672>.</span>utils<span style=color:#f92672>.</span>get_file(<span style=color:#e6db74>&#39;kandinsky5.jpg&#39;</span>,<span style=color:#e6db74>&#39;https://storage.googleapis.com/download.tensorflow.org/example_images/Vassily_Kandinsky%2C_1913_-_Composition_7.jpg&#39;</span>)
</span></span></code></pre></div><p>With changing for example the yellow labrador dog url into the Warsaw University of Technology main building url and re-run a few cells.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>content_path <span style=color:#f92672>=</span> tf<span style=color:#f92672>.</span>keras<span style=color:#f92672>.</span>utils<span style=color:#f92672>.</span>get_file(<span style=color:#e6db74>&#39;1280px-Gmach_G%C5</span><span style=color:#e6db74>%82%</span><span style=color:#e6db74>C3%B3wny_Politechniki_Warszawskiej_2018.jpg&#39;</span>, <span style=color:#e6db74>&#39;https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Gmach_G%C5</span><span style=color:#e6db74>%82%</span><span style=color:#e6db74>C3%B3wny_Politechniki_Warszawskiej_2018.jpg/1280px-Gmach_G%C5</span><span style=color:#e6db74>%82%</span><span style=color:#e6db74>C3%B3wny_Politechniki_Warszawskiej_2018.jpg&#39;</span>)
</span></span></code></pre></div><p><img src=/posts/playing-with-style-transfer/ggpw_abstro.png alt="Abstract WUT Main Building"></p><h3 id=adjusting-for-images-from-you-local-disk>Adjusting for images from you local disk
<a href=#adjusting-for-images-from-you-local-disk class=h-anchor aria-hidden=true>#</a></h3><p>If you want to upload an image from your local disk to process you can do it as well!
Just click here and there:</p><p><img src=/posts/playing-with-style-transfer/upload.png alt></p><p>and adjust a cell from</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>content_image <span style=color:#f92672>=</span> load_img(content_path)
</span></span><span style=display:flex><span>style_image <span style=color:#f92672>=</span> load_img(style_path)
</span></span></code></pre></div><p>to</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>content_image <span style=color:#f92672>=</span> load_img(<span style=color:#e6db74>&#34;the-eiffel-tower.jpg&#34;</span>)
</span></span><span style=display:flex><span>style_image <span style=color:#f92672>=</span> load_img(<span style=color:#e6db74>&#34;a-summer-evening-in-the-city.jpg&#34;</span>)
</span></span></code></pre></div><p>and re run everything.</p><p><img src=/posts/playing-with-style-transfer/eiffel.png alt="Eiffel Tower in Van Gogh Style"></p><p>A summer evening <del>in the city</del> with the Eiffel Tower.</p><h2 id=summary>Summary
<a href=#summary class=h-anchor aria-hidden=true>#</a></h2><p>Colab notebooks is a great online service.
I hope this post made it clear how to do your own experiments with style transfer.
And the best part is that if you are curious how style transfer works, what are the details of methods used, just follow the notebook till the end!</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/solar-panels-4/><span class=button__icon>←</span>
<span class=button__text>Streamlit Tutorial: How to Deploy Streamlit Apps on RStudio Connect 💰</span></a></span>
<span class="button next"><a href=/posts/sfi-conference/><span class=button__text>SFI Conference 👨‍🏫🎉</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user">Piotr Pasza Storożenko</div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-PR8Z9SJC7F"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PR8Z9SJC7F",{anonymize_ip:!1})}</script></body></html>